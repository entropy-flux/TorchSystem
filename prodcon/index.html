
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../services/">
      
      
        <link rel="next" href="../pubsub/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Producer/Consumer - TorchSystem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-ocurrences-in-your-services-and-handle-them-with-the-producerconsumer-pattern" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TorchSystem" class="md-header__button md-logo" aria-label="TorchSystem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TorchSystem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Producer/Consumer
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TorchSystem" class="md-nav__button md-logo" aria-label="TorchSystem" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TorchSystem
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registry
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../depends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependency Injection
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../compiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compiler
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Producer/Consumer
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Producer/Consumer
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-ocurrences-in-your-services-and-handle-them-with-the-producerconsumer-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Model ocurrences in your services and handle them with the producer/consumer pattern.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon" class="md-nav__link">
    <span class="md-ellipsis">
      prodcon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer" class="md-nav__link">
    <span class="md-ellipsis">
      Consumer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.dependency_overrides" class="md-nav__link">
    <span class="md-ellipsis">
      dependency_overrides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      consume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.handler" class="md-nav__link">
    <span class="md-ellipsis">
      handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.override" class="md-nav__link">
    <span class="md-ellipsis">
      override
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer" class="md-nav__link">
    <span class="md-ellipsis">
      Producer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer.dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      dispatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.event" class="md-nav__link">
    <span class="md-ellipsis">
      event
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publisher/Subscriber
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-ocurrences-in-your-services-and-handle-them-with-the-producerconsumer-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Model ocurrences in your services and handle them with the producer/consumer pattern.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon" class="md-nav__link">
    <span class="md-ellipsis">
      prodcon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer" class="md-nav__link">
    <span class="md-ellipsis">
      Consumer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.dependency_overrides" class="md-nav__link">
    <span class="md-ellipsis">
      dependency_overrides
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      consume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.handler" class="md-nav__link">
    <span class="md-ellipsis">
      handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.override" class="md-nav__link">
    <span class="md-ellipsis">
      override
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Consumer.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer" class="md-nav__link">
    <span class="md-ellipsis">
      Producer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer.dispatch" class="md-nav__link">
    <span class="md-ellipsis">
      dispatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.Producer.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#torchsystem.services.prodcon.event" class="md-nav__link">
    <span class="md-ellipsis">
      event
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Producer/Consumer</h1>

<h3 id="model-ocurrences-in-your-services-and-handle-them-with-the-producerconsumer-pattern">Model ocurrences in your services and handle them with the producer/consumer pattern.</h3>


<div class="doc doc-object doc-module">



<a id="torchsystem.services.prodcon"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="torchsystem.services.prodcon.Consumer" class="doc doc-heading">
            <code>Consumer</code>


</h2>


    <div class="doc doc-contents ">


        <p>A CONSUMER is a component that listens for and reacts to ocurrences in a BOUNDED CONTEXT. Occurrences
can be modeled as events and should contain all the information needed to describe what happened in
the system. Then CONSUMERs are responsible for processing events and triggering side effects in response
to them.</p>
<p>Unlike a SUBSCRIBER, that receive messages routed by the PUBLISHER, a CONSUMER is responsible
for deciding which handlers to invoke based on the type of the message it consumes. The message type should
describe the ocurrence in past tense as DDD suggests when modeling events.</p>
<p>The EVENTS should be modeled with UBIQUITOUS LANGUAGE. This means that the names of the events should reflect
the domain ocurrences that the consumer is responsible for. Keep this in mind when naming the events that will
be consumed by the consumer. The consumer maps it's handlers to keys generated by the EVENT's name.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="torchsystem.services.prodcon.Consumer.register" href="#torchsystem.services.prodcon.Consumer.register">register</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Registers a message type and its corresponding handler function.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="torchsystem.services.prodcon.Consumer.handler" href="#torchsystem.services.prodcon.Consumer.handler">handler</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Decorator for registering a handler function for one or more message types.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="torchsystem.services.prodcon.Consumer.consume" href="#torchsystem.services.prodcon.Consumer.consume">consume</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Consumes a message by invoking its registered handler functions.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">torchsystem.services</span><span class="w"> </span><span class="kn">import</span> <span class="n">Consumer</span><span class="p">,</span> <span class="n">event</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchsystem.services</span><span class="w"> </span><span class="kn">import</span> <span class="n">Publisher</span>

<span class="nd">@event</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelTrained</span><span class="p">:</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span>

<span class="nd">@event</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelEvaluated</span><span class="p">:</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span>

<span class="n">consumer</span> <span class="o">=</span> <span class="n">Consumer</span><span class="p">()</span>
<span class="n">publisher</span> <span class="o">=</span> <span class="n">Publisher</span><span class="p">()</span>

<span class="nd">@consumer</span><span class="o">.</span><span class="n">handler</span>
<span class="k">def</span><span class="w"> </span><span class="nf">on_model_iterated</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">ModelTrained</span> <span class="o">|</span> <span class="n">ModelEvaluated</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>
        <span class="n">publisher</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">metric</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

<span class="n">consumer</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">ModelTrained</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">}]))</span>
<span class="n">consumer</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">ModelEvaluated</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">}]))</span>
</code></pre></div>
</details>








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="torchsystem.services.prodcon.Consumer.dependency_overrides" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dependency_overrides</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the dependency overrides for the consumer. This is useful for late binding, 
testing and changing the behavior of the consumer in runtime.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of the dependency map.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Consumer.consume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">consume</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Consumes a message by invoking its registered handler functions. If the message type is not registered
with any handler, it will be ignored.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to consume.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Consumer.handler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handler</span><span class="p">(</span><span class="n">wrapped</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Decorator for registering a handler function for one or more message types. The handler is registered
with the name of the function as the key. The handler is also injected with the dependencies provided by
the consumer.</p>
<p>Each message type can have multiple handlers registered to it and each handler can be registered to multiple
message at the same time using unions. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>wrapped</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to be registered as a handler.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable[..., None]: The injected handler function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Consumer.override" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">override</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span> <span class="n">implementation</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Overrides a dependency with an implementation. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dependency</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dependency function to override.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>implementation</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The implementation of the function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Consumer.register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Registers a message type and its corresponding handler function. Handles nested or generic annotations
and union types. If the annotation is a union type, it will register the handler for each of its arguments.</p>
<p>This method is used to register a handler from the <code>handler</code> method and should not be called directly. Use
the <code>handler</code> decorator instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message annotation to be registered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>handler</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The handler function to be registered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable[..., None]: The injected handler function at the end of the recursion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="torchsystem.services.prodcon.Producer" class="doc doc-heading">
            <code>Producer</code>


</h2>


    <div class="doc doc-contents ">


        <p>A producer is responsible for
emitting EVENTS that are consumed by consumers. You can implement a producer implementing the <code>register</code>
method to register consumers, and some delivery mechanism to deliver the events to them.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="torchsystem.services.prodcon.Producer.register" href="#torchsystem.services.prodcon.Producer.register">register</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Registers a consumer to the producer.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="torchsystem.services.prodcon.Producer.dispatch" href="#torchsystem.services.prodcon.Producer.dispatch">dispatch</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Dispatches an event to all registered consumers.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">torchsystem.services</span><span class="w"> </span><span class="kn">import</span> <span class="n">Consumer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchsystem.services</span><span class="w"> </span><span class="kn">import</span> <span class="n">Producer</span><span class="p">,</span> <span class="n">event</span>

<span class="nd">@event</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelTrained</span><span class="p">:</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span>

<span class="nd">@event</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelEvaluated</span><span class="p">:</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span>
<span class="o">...</span>

<span class="n">producer</span> <span class="o">=</span> <span class="n">Producer</span><span class="p">()</span>
<span class="n">producer</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">consumer</span><span class="p">)</span>
<span class="n">producer</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">ModelTrained</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">}]))</span>     
</code></pre></div>
</details>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Producer.dispatch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dispatch</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Dispatches an event to all registered consumers. The event will be consumed by the consumers that have
registered handlers for the event type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event to dispatch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchsystem.services.prodcon.Producer.register" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register</span><span class="p">(</span><span class="o">*</span><span class="n">consumers</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Registers a sequence of consumers to the producer. The producer will dispatch events to all registered
consumers.</p>

    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="torchsystem.services.prodcon.event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">event</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A decorator to define an Event message. An event will store weak references to objects
and is meant to be consumed by consumers inside the scope where they are produced.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cls</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ocurrence of something that happened represented by a class</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>type</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataclass representing the event.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">torchsystem.services</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>

<span class="nd">@event</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelTrained</span><span class="p">:</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span>
</code></pre></div>
</details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.code.highlight"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>